{% extends 'base.html.twig' %}

{% block title %}Plumbill
{% endblock %}

{% block body %}
	{% include 'components/Navbar.html.twig' %}

	<main class="mx-2 mt-2">
		<header class="mb-2 p-1">
			<h1 class="font-bold text-3xl">Liste des devis</h1>
		</header>
		<section class="mb-2 p-1 bg-white shadow-sm">
			<details>
				<summary class="font-bold">Filtres</summary>
				{{ form_start(searchForm, {'method': 'POST' }) }}
				{{ form_label(searchForm.status) }}
				{{ form_widget(searchForm.status, {widget_class: "mb-2 flex gap-2" }) }}
				{{ form_rest(searchForm)  }}
				<button id="quote_search_submit" type="submit" class="rounded px-2 py-1 bg-blue-800 font-bold text-white disabled:bg-blue-200" {% if not searchForm.status.vars.value %}disabled{% endif %}>Filtrer</button>
				{{ form_end(searchForm) }}

			</details>
		</section>
		<section class="flex flex-col w-full gap-1">
			{% for quote in quotes %}
				<twig:QuoteListItem :quote="quote" />
			{% endfor %}
		</section>
	</main>
	<script>
		const submitBtn = document.getElementById("quote_search_submit");
		const formEl = document.querySelector("form");

		/**
		 *
		 * @type {NodeListOf<HTMLInputElement>}
		 */
		const checkboxesEl = formEl.querySelectorAll("input[type='checkbox']");
		let isDisabled = true;

		for (const checkboxEl of checkboxesEl) {
			checkboxEl.addEventListener("change", function (ev) {
				for (const checkbox of checkboxesEl) {
					if (checkbox.checked) {
						isDisabled = false;
						break;
					} else {
						isDisabled = true;
					}
				}

				if (isDisabled) {
					submitBtn.setAttribute("disabled", '');
				} else {
					submitBtn.removeAttribute("disabled");
				}
			});
		}

		if (isDisabled) {
			submitBtn.setAttribute("disabled", '');
		}



	</script>
{% endblock %}


